# 🎒 个性化课表油猴脚本 | Custom Timetable UserScript  
**适配平台**：学院教务系统（[xs.whggvc.net](https://xs.whggvc.net/)）  
**核心定位**：一站式课表信息增强+样式自定义工具，让教务系统课表从“精简”变“精致”，信息一目了然！  
**遗留bug未修**：为避免重构网页导致数据异常，所以数据是获取数据源后添加进网页前端，需切换周次，刷新周次即可跳过本周不显示详细数据的bug！！！


## 🚀 核心功能亮点  
| 图标 | 功能名称 | 核心优势 |
|------|----------|----------|
| 📝 **信息增强** | 课程数据智能优化 | 自动提取并美化「教室、教师、日期、周次」，教室编号简化（如 `藏龙岛1教J101` → `1-101`，`综A203` → `综203`） |
| 🎨 **样式自定义** | 全维度可视化调整 | 支持8项核心样式配置（字体大小、上下间距），输入数值**实时预览效果**，无需反复刷新 |
| 🔄 **智能监测** | 数据变化自动响应 | 周次更新时自动刷新所有课程，课程数据未变则跳过重复渲染，避免性能浪费，但目前是实时更新 |
| 📱 **响应式适配** | 多设备无缝切换 | 自动识别手机/电脑屏幕，模态框、课表布局智能调整，手机端也能清晰操作 |
| 💾 **本地持久化** | 设置永不丢失 | 自定义样式保存到浏览器本地（localStorage），关闭页面/刷新后依然生效 |


## 📥 前置准备 & 安装步骤  
### 1. 安装油猴插件（Tampermonkey）  
脚本依赖油猴插件运行，先根据你的浏览器安装对应版本：  
- **Chrome/Edge**：[Chrome 应用商店](https://chrome.google.com/webstore/detail/tampermonkey/dhdgffkkebhmkfjojejmpbldmpobfkfo)（需科学上网）｜[Edge 应用商店](https://microsoftedge.microsoft.com/addons/detail/tampermonkey/iikmkjmpaadaobahmlepeloendndfphd)（国内可直接安装）  
- **Firefox**：[Firefox 附加组件](https://addons.mozilla.org/zh-CN/firefox/addon/tampermonkey/)  
- **手机端**：推荐用「Alook浏览器」或「Kiwi浏览器」，在扩展商店搜索安装 Tampermonkey  

![油猴插件安装示意图预览链接](https://placeholder.com/tampermonkey-install)  
*（提示：实际截图可能不同，界面或有差异）*


### 2. 导入脚本  
1. 点击浏览器右上角的「油猴图标」→ 选择「创建新脚本」  
   ![创建新脚本](https://placeholder.com/tampermonkey-new-script)  
2. 删除编辑器中默认的所有代码，将本文开头的**完整脚本代码**复制粘贴进去  
3. 按下 `Ctrl+S`（或点击编辑器顶部「文件」→「保存」），脚本自动启用  
   ![保存脚本](https://placeholder.com/tampermonkey-save-script)  


## 🎯 详细使用教程  
### 步骤1：进入课表页面  
打开教务系统课表地址：[https://xs.whggvc.net/](https://xs.whggvc.net/)，登录后等待页面加载完成（脚本会自动获取数据检测并修改课表）。  


### 步骤2：打开个性化设置面板  
在页面顶部导航区找到「**个性化**」按钮（在右上角，脚本已将原按钮替换为该名称），点击后弹出设置面板：  
![个性化按钮位置](https://github.com/whggvc/course-table/blob/9f988e37d44ab6be2e8e5ca38e527d85dd118e71/Image%20example/2052-09-01_02-14-43.png)  
*（提示：若未找到按钮，刷新页面重试，确保脚本已启用）*


### 步骤3：自定义课表样式  
设置面板包含8项可调整参数，每一项都支持**实时预览**：  
| 设置项名称 | 作用说明 | 操作示例 |
|------------|----------|----------|
| 教室文字margin-top | 调整“教室编号”文字的上间距 | 输入 `-20` → 教室文字向上移动 |
| 教室文字字体大小 | 调整“教室编号”的字体尺寸 | 输入 `16` → 教室文字变大 |
| 星期与之周margin-top | 调整“周几-周次”文字的上间距 | 输入 `-12` → 该文字向上靠拢 |
| 星期与之周字体大小 | 调整“周几-周次”的字体尺寸 | 输入 `11` → 文字更清晰 |
| 教师名字margin-top | 调整“教师姓名”文字的上间距 | 输入 `-18` → 减少空白区域 |
| 教师名字字体大小 | 调整“教师姓名”的字体尺寸 | 输入 `13` → 姓名更醒目 |
| 年月日时间margin-top | 调整“日期”文字的上间距 | 输入 `-15` → 优化排版 |
| 年月日时间字体大小 | 调整“日期”的字体尺寸 | 输入 `9` → 不占用过多空间 |

👉 **操作演示**：修改“教室文字字体大小”为 `16`，**保存后**课表中所有教室编号在刷新后变大！  
![样式调整实时预览 预设链接](https://github.com/whggvc/course-table/blob/f81bb15b239a47837a7567ceec543edb65aab27f/Image%20example/2052-09-01_02-27-47.png)  
*（此处使用GIF展示“输入数值→保存后详细文字变化”的过程，但脚本设置页老土，即素材未录制）*


### 步骤4：保存/恢复设置  
- **保存设置**：调整完成后点击「保存」按钮，所有配置会存入本地，下次打开自动生效  
- **恢复默认**：若觉得样式混乱，点击「恢复默认」按钮，立即回到初始配置（默认值见上表）  


### 步骤5：查看最终效果  
设置完成后，课表会呈现以下优化效果：  
1. 教室编号简化：`xxx 3教J205` → `3-205`  
2. 信息分层清晰：教室（加粗醒目）→ 周次 → 教师 → 日期  
3. 间距合理：无多余空白，一页能显示更多课程  
![美化后课表效果](https://github.com/whggvc/course-table/blob/9f988e37d44ab6be2e8e5ca38e527d85dd118e71/Image%20example/2052-09-01_02-13-42.png)  


## 🔍 进阶功能解析  
### 1. 课程数据智能处理逻辑  
脚本会自动解析教务系统返回的原始数据，做以下优化：  
- **周次监测**：若系统显示“第8周”变为“第9周”，脚本会自动清除旧数据，重新渲染所有课程，但目前仍有直接进入当前（本）周次不显示的bug未修复  
- **哈希校验**：用 `simpleHash` 算法计算课程数据哈希值，数据未变则不重复修改DOM，提升页面流畅度  
- **异常兼容**：若某课程缺少教师/教室信息，会显示“未提供教师信息”等占位文本，避免样式错乱  


### 2. 手机端适配细节  
当屏幕宽度＜768px（手机横向/纵向）时，脚本会：  
- 模态框宽度调整为「90%屏幕宽度」，避免超出视野  
- 遮罩层透明度提升至80%，减少外界干扰  
- 输入框放大，方便手指点击输入  


## ❓ 常见问题（FAQ）  
### Q1：脚本安装后没反应？  
A1：检查以下3点：  
1. 油猴插件是否已启用（图标为彩色而非灰色）  
2. 脚本的「匹配地址」是否包含 `https://xs.whggvc.net/*`（编辑脚本时查看 `@match` 字段）  
3. 清除浏览器缓存（Ctrl+Shift+Del），重新登录教务系统  


### Q2：“个性化”按钮找不到？  
A2：  
1. 确保课表页面已完全加载（等待“加载中”提示消失）  
2. 若系统更新了页面结构，需修改脚本中 `modifyTargetElement` 函数的目标选择器（当前为 `body > uni-app > uni-page > ... > uni-view:nth-child(3)`）  


### Q3：设置保存后刷新就没了？  
A3：  
- 浏览器「隐私模式」会清空localStorage，建议关闭隐私模式使用  
- 若手动清除过浏览器数据（如Cookie、缓存），设置会丢失，需重新配置  


## ⚠️ 注意事项  
1. **仅适配指定平台**：脚本仅针对 `xs.whggvc.net` 开发，其他学校的教务系统（如 `jwgl.xxx.edu.cn`）无法使用  
2. **避免脚本冲突**：建议别同时启用多个“课表美化”类脚本，可能导致样式混乱  
3. **系统更新兼容**：若学校更新教务系统界面，脚本的DOM选择器可能失效，需联系开发者更新或自行魔改  


## 🤝 贡献与反馈  
如果发现bug、有新功能建议，欢迎通过以下方式反馈：  
- **GitHub仓库**：[Custom-Timetable-UserScript](https://github.com/whggvc/course-table.git)（仓库地址）  
- **反馈邮箱**：example@abc.com （暂无） 
- **QQ交流群**：（暂无）  

欢迎提交PR改进代码，但是我懒洋洋，所以优化这个工具还得你自己！（捂嘴😀）


## 📄 许可证  
本脚本基于 **MIT许可证** 开源，可自由修改、分发，但需保留原作者信息（当前 `@author` 为 `everyone`）。
